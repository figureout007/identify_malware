Type - Remote Access Trojan (RAT)
OS Impacted - Android
Similar RATs - OmniRAT, DroidJack
Source - Typically found in .apk files that are downloadable through a website or from a phishing campaign and not .apk files present in Google App Store.


Risk for personal device owners

The impact will be but not limited to Confidentiality and Privacy.

Impact Score - 3
Frequency - 3
Risk - High Risk

Identification of Malware

1. Application downloaded from a third party source.
2. Use Malwarebytes for Android.
3. Analyse AndroidManifest.xml for the below mentioned permissions:-

You can find AndroidManifest.xml inside the .apk file. Verify the below mentioned permissions with the application's functionality.

  <uses-permission android:name="android.permission.ACCESS_SUPERUSER" />
  <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
  <uses-permission android:name="android.permission.RECEIVE_SMS" />
  <uses-permission android:name="android.permission.READ_SMS" />
  <uses-permission android:name="android.permission.SEND_SMS" />
  <uses-permission android:name="android.permission.READ_PHONE_STATE" />
  <uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS" />
  <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
  <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />
  <uses-permission android:name="android.permission.INTERNET" />
  <uses-permission android:name="android.permission.RECORD_AUDIO" />
  <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
  <uses-permission android:name="android.permission.CAMERA" />
  <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
  <uses-permission android:name="android.permission.CALL_PHONE" />
  <uses-permission android:name="android.permission.READ_CONTACTS" />
   
   The above list of permissions are not exhaustive. Please check the features to explore more permissions.
   
4. Lookout for Clickjacking using accessibility services. https://www.makeuseof.com/tag/android-accessibility-services-can-used-hack-phone/
5. Use of uncommon TCP ports to transfer network traffic.
6. Uses custom TCP Protocol for Command & Control communications (a technique used by threat actors to communicate with compromised devices over a network).
7. The traffic starts with payload size followed by a null byte 0x00. The payload from the victim is GZIP-DEFLATE compressed and starts with 0x1f8b08 bytes.


Features which identifies Spynote Trojan:- 

1. Can update itself
2. Download & Install new apps
3. View SMS Messages
4. Access the phone's last GPS location
5. Listen to/record audio from device's microphone
6. Access to Video Camera
7. Listen to Calls
8. Make Calls
9. Retreive Contact Lists
10. Access technical details such as the device IMEI number, WiFi MAC address, and carrier details.

References

1. Static Code Analysis is documented in this - https://bulldogjob.pl/readme/an-in-depth-analysis-of-spynote-remote-access-trojan
2. Packet Bytes Pane - https://www.wireshark.org/docs/wsug_html_chunked/ChUsePacketBytesPaneSection.html
3. https://unit42.paloaltonetworks.com/unit42-spynote-android-trojan-builder-leaked/
